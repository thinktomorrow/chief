!(function (i) {
    i.add('plugin', 'clips', {
        translations: { en: { clips: 'Clips', 'clips-select': 'Please, select a clip' } },
        modals: { clips: '' },
        init(i) {
            (this.app = i),
                (this.opts = i.opts),
                (this.lang = i.lang),
                (this.toolbar = i.toolbar),
                (this.insertion = i.insertion);
        },
        onmodal: {
            clips: {
                open(i) {
                    this._build(i);
                },
            },
        },
        start() {
            if (this.opts.clips) {
                const i = { title: this.lang.get('clips'), api: 'plugin.clips.open' };
                this.toolbar.addButton('clips', i).setIcon('<i class="re-icon-clips"></i>');
            }
        },
        open(i) {
            const t = { title: this.lang.get('clips'), width: '600px', name: 'clips' };
            this.app.api('module.modal.build', t);
        },
        _build(i) {
            const t = i.getBody();
            const s = this._buildLabel();
            const l = this._buildList();
            this._buildItems(l), t.html(''), t.append(s), t.append(l);
        },
        _buildLabel() {
            const t = i.dom('<label>');
            return t.html(this.lang.parse('## clips-select ##:')), t;
        },
        _buildList() {
            const t = i.dom('<ul>');
            return t.addClass('redactor-clips-list'), t;
        },
        _buildItems(t) {
            for (let s = this.opts.clips, l = 0; l < s.length; l++) {
                const n = i.dom('<li>');
                const a = i.dom('<span>');
                a.attr('data-index', l),
                    a.html(s[l][0]),
                    a.on('click', this._insert.bind(this)),
                    n.append(a),
                    t.append(n);
            }
        },
        _insert(t) {
            const s = i.dom(t.target).attr('data-index');
            const l = this.opts.clips[s][1];
            this.app.api('module.modal.close'), this.insertion.insertRaw(l);
        },
    });
})(Redactor);
